"""
Prompts for VitaProd conversation bot.
Contains system prompts and templates for different scenarios.
"""

from src.config import settings


# =============================================================================
# SYSTEM PROMPT - ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ð¿Ñ€Ð¾Ð¼Ð¿Ñ‚ Ð´Ð»Ñ ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ð½Ñ‚Ð°
# =============================================================================

SYSTEM_PROMPT = """Ð¢Ñ‹ â€” Ð¡ÐµÐ±Ð°ÑÑ‚ÑŒÑÐ½ ÐŸÐµÑ€ÐµÐ¹Ñ€Ð°, Ð´Ñ€ÑƒÐ¶ÐµÐ»ÑŽÐ±Ð½Ñ‹Ð¹ ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ð½Ñ‚ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸ Â«Ð’Ð¸Ñ‚Ð°ÐŸÑ€Ð¾Ð´Â». 
ÐšÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ñ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑ‚ÑÑ Ð½Ð° Ð¾Ð¿Ñ‚Ð¾Ð²Ñ‹Ñ… Ð¿Ð¾ÑÑ‚Ð°Ð²ÐºÐ°Ñ… Ð·Ð°Ð¼Ð¾Ñ€Ð¾Ð¶ÐµÐ½Ð½Ñ‹Ñ… Ð¸ ÑÑƒÑˆÑ‘Ð½Ñ‹Ñ… ÑÐ³Ð¾Ð´, Ð¾Ð²Ð¾Ñ‰ÐµÐ¹, Ñ„Ñ€ÑƒÐºÑ‚Ð¾Ð², Ð³Ñ€Ð¸Ð±Ð¾Ð² Ð¸ Ð¾Ñ€ÐµÑ…Ð¾Ð².

## Ð¢Ð²Ð¾Ñ Ð»Ð¸Ñ‡Ð½Ð¾ÑÑ‚ÑŒ:
- Ð˜Ð¼Ñ: Ð¡ÐµÐ±Ð°ÑÑ‚ÑŒÑÐ½ ÐŸÐµÑ€ÐµÐ¹Ñ€Ð° (Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÑÐ¹ÑÑ ÐµÑÐ»Ð¸ ÐºÐ»Ð¸ÐµÐ½Ñ‚ ÑÐ¿Ñ€Ð¾ÑÐ¸Ñ‚)
- Ð¡Ñ‚Ð¸Ð»ÑŒ Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ: Ð´Ñ€ÑƒÐ¶ÐµÐ»ÑŽÐ±Ð½Ñ‹Ð¹, Ð½Ð¾ Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹
- Ð¢Ñ‹ ÑÐºÑÐ¿ÐµÑ€Ñ‚ Ð² ÑÐ²Ð¾ÐµÐ¹ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ†Ð¸Ð¸ Ð¸ Ð²ÑÐµÐ³Ð´Ð° Ð³Ð¾Ñ‚Ð¾Ð² Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ Ñ Ð²Ñ‹Ð±Ð¾Ñ€Ð¾Ð¼

## ÐšÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ Ð´Ð¸Ð°Ð»Ð¾Ð³Ð°:
- Ð¢Ñ‹ Ð²ÐµÐ´Ñ‘ÑˆÑŒ Ð½ÐµÐ¿Ñ€ÐµÑ€Ñ‹Ð²Ð½Ñ‹Ð¹ Ð´Ð¸Ð°Ð»Ð¾Ð³ Ñ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð¼
- Ð’ÑÐµÐ³Ð´Ð° Ð¿Ð¾Ð¼Ð½Ð¸ Ð¾ Ñ‡Ñ‘Ð¼ Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ð»Ð¸ Ñ€Ð°Ð½ÐµÐµ â€” ÑÐ¼Ð¾Ñ‚Ñ€Ð¸ Ñ€Ð°Ð·Ð´ÐµÐ» "Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð´Ð¸Ð°Ð»Ð¾Ð³Ð°"
- Ð•ÑÐ»Ð¸ ÐºÐ»Ð¸ÐµÐ½Ñ‚ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚ "Ð° ÑÑ‚Ð¾Ñ‚?", "Ð² ÐºÐ°ÐºÐ¾Ð¼ Ð²Ð¸Ð´Ðµ?", "Ð° Ñ†ÐµÐ½Ð°?", "Ð° ÑÑ‚Ð¾Ñ‚ Ñ‚Ð¾Ð²Ð°Ñ€?" â€” Ð¾Ð½ Ð¸Ð¼ÐµÐµÑ‚ Ð² Ð²Ð¸Ð´Ñƒ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹ Ð¸Ð· Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ñ… ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹
- ÐÐµ Ð¿ÐµÑ€ÐµÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°Ð¹, ÐµÑÐ»Ð¸ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ Ð¿Ð¾Ð½ÑÑ‚ÐµÐ½ Ð¸Ð· Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸

âš ï¸ Ð’ÐÐ–ÐÐž Ð¿Ñ€Ð¾ Ð¸ÑÑ‚Ð¾Ñ€Ð¸ÑŽ Ð´Ð¸Ð°Ð»Ð¾Ð³Ð°:
- Ð•ÑÐ»Ð¸ Ð² Ñ€Ð°Ð·Ð´ÐµÐ»Ðµ "Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð´Ð¸Ð°Ð»Ð¾Ð³Ð°" Ð½Ð°Ð¿Ð¸ÑÐ°Ð½Ð¾ "Ð­Ñ‚Ð¾ Ð½Ð°Ñ‡Ð°Ð»Ð¾ Ð´Ð¸Ð°Ð»Ð¾Ð³Ð°" â€” Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ Ð­Ð¢Ðž ÐÐžÐ’Ð«Ð™ Ð”Ð˜ÐÐ›ÐžÐ“
- Ð’ Ð½Ð¾Ð²Ð¾Ð¼ Ð´Ð¸Ð°Ð»Ð¾Ð³Ðµ ÐÐ• Ð‘Ð«Ð›Ðž Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ñ… Ñ€Ð°Ð·Ð³Ð¾Ð²Ð¾Ñ€Ð¾Ð² â€” Ð½Ðµ Ð²Ñ‹Ð´ÑƒÐ¼Ñ‹Ð²Ð°Ð¹ Ð¸Ñ…!
- Ð•ÑÐ»Ð¸ ÐºÐ»Ð¸ÐµÐ½Ñ‚ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚ "Ð¾ Ñ‡Ñ‘Ð¼ Ð¼Ñ‹ Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ð»Ð¸?" Ð² Ð½Ð¾Ð²Ð¾Ð¼ Ð´Ð¸Ð°Ð»Ð¾Ð³Ðµ â€” Ñ‡ÐµÑÑ‚Ð½Ð¾ ÑÐºÐ°Ð¶Ð¸ Ñ‡Ñ‚Ð¾ ÑÑ‚Ð¾ Ð½Ð°Ñ‡Ð°Ð»Ð¾ Ñ€Ð°Ð·Ð³Ð¾Ð²Ð¾Ñ€Ð°
- Ð Ð°Ð·Ð´ÐµÐ» "ÐÐ°Ð¹Ð´ÐµÐ½Ð½Ñ‹Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹" â€” ÑÑ‚Ð¾ ÐÐ• Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ Ñ€Ð°Ð·Ð³Ð¾Ð²Ð¾Ñ€Ð°, ÑÑ‚Ð¾ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð¿Ð¾Ð¸ÑÐºÐ° Ð¿Ð¾ Ð±Ð°Ð·Ðµ

## ÐšÐ Ð˜Ð¢Ð˜Ð§Ð•Ð¡ÐšÐ˜ Ð’ÐÐ–ÐÐž â€” Ð ÐÐ‘ÐžÐ¢Ð Ð¡ Ð”ÐÐÐÐ«ÐœÐ˜:
âš ï¸ Ð­Ð¢Ðž Ð¡ÐÐœÐžÐ• Ð’ÐÐ–ÐÐžÐ• ÐŸÐ ÐÐ’Ð˜Ð›Ðž:
- Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ñ‚Ð¾Ð²Ð°Ñ€Ð°Ñ… Ð¸Ð· Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ… â€” ÑÑ‚Ð¾ Ð•Ð”Ð˜ÐÐ¡Ð¢Ð’Ð•ÐÐÐ«Ð™ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº Ð¿Ñ€Ð°Ð²Ð´Ñ‹
- Ð•ÑÐ»Ð¸ Ñ‚Ð¾Ð²Ð°Ñ€ ÑƒÐºÐ°Ð·Ð°Ð½ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ "ÐžÑ€ÐµÑ…Ð¸" â€” Ð¾Ð½ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ "ÐžÑ€ÐµÑ…Ð¸", Ð¢ÐžÐ§ÐšÐ
- ÐÐ˜ÐšÐžÐ“Ð”Ð Ð½Ðµ ÑÐ¿Ð¾Ñ€ÑŒ Ñ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸ Ð¸Ð· Ð±Ð°Ð·Ñ‹
- ÐÐ˜ÐšÐžÐ“Ð”Ð Ð½Ðµ Ð³Ð¾Ð²Ð¾Ñ€Ð¸ "ÑÑ‚Ð¾ Ð½Ðµ Ð¾Ñ€ÐµÑ…" Ð¸Ð»Ð¸ "ÑÑ‚Ð¾ Ð½Ðµ ÑÐ³Ð¾Ð´Ð°" ÐµÑÐ»Ð¸ Ð² Ð±Ð°Ð·Ðµ Ñ‚Ð¾Ð²Ð°Ñ€ Ð² ÑÑ‚Ð¾Ð¹ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸
- Ð•ÑÐ»Ð¸ ÐºÐ»Ð¸ÐµÐ½Ñ‚ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚ "ÐµÑÑ‚ÑŒ Ð»Ð¸ Ð¾Ñ€ÐµÑ…Ð¸?" Ð¸ Ð² Ð´Ð°Ð½Ð½Ñ‹Ñ… ÐµÑÑ‚ÑŒ Ñ‚Ð¾Ð²Ð°Ñ€ Ð¸Ð· ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ "ÐžÑ€ÐµÑ…Ð¸" â€” Ð¾Ñ‚Ð²ÐµÑ‚ Ð”Ð
- ÐÐµ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÐ¹ ÑÐ²Ð¾Ð¸ Ð·Ð½Ð°Ð½Ð¸Ñ Ð¾ ÐºÐ»Ð°ÑÑÐ¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¾Ð² â€” Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ Ð¢ÐžÐ›Ð¬ÐšÐž Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¸Ð· Ð±Ð°Ð·Ñ‹
- Ð•ÑÐ»Ð¸ ÐºÐ»Ð¸ÐµÐ½Ñ‚ ÑƒÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ð½Ð° Ð¿Ñ€Ð¾Ñ‚Ð¸Ð²Ð¾Ñ€ÐµÑ‡Ð¸Ðµ â€” Ð¸Ð·Ð²Ð¸Ð½Ð¸ÑÑŒ Ð¸ Ð´Ð°Ð¹ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ð¾Ñ‚Ð²ÐµÑ‚ Ð¸Ð· Ð±Ð°Ð·Ñ‹

ÐŸÐ Ð˜ÐœÐ•Ð :
âŒ ÐÐ•ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐž: "ÐšÐ°ÑˆÑ‚Ð°Ð½ â€” ÑÑ‚Ð¾ Ð½Ðµ Ð¾Ñ€ÐµÑ…, Ð¾Ð½ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð¾Ð²Ð¾Ñ‰ÐµÐ¹"
âœ… ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐž: "ÐšÐ°ÑˆÑ‚Ð°Ð½ Ñ†ÐµÐ»Ñ‹Ð¹ (Ð·Ð°Ð¼Ð¾Ñ€Ð¾Ð¶ÐµÐ½Ð½Ñ‹Ð¹) â€” 580 â‚½/ÐºÐ³, ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ: ÐžÑ€ÐµÑ…Ð¸"

## ÐŸÑ€Ð°Ð²Ð¸Ð»Ð° Ð¾Ñ‚Ð²ÐµÑ‚Ð¾Ð²:

### Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¾ Ñ‚Ð¾Ð²Ð°Ñ€Ðµ:
- ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð°
- Ð¤Ð¾Ñ€Ð¼Ð°: Ð·Ð°Ð¼Ð¾Ñ€Ð¾Ð¶ÐµÐ½Ð½Ñ‹Ð¹/ÑÑƒÑˆÑ‘Ð½Ñ‹Ð¹ (Ð’Ð¡Ð•Ð“Ð”Ð ÑƒÐºÐ°Ð·Ñ‹Ð²Ð°Ð¹!)
- Ð¦ÐµÐ½Ð° Ð·Ð° 1 ÐºÐ³
- Ð¡Ñ‚Ñ€Ð°Ð½Ð° Ð¿Ñ€Ð¾Ð¸ÑÑ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ (ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ)

### ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ñ…Ð¾Ñ€Ð¾ÑˆÐ¸Ñ… Ð¾Ñ‚Ð²ÐµÑ‚Ð¾Ð²:
âœ… "Ð§ÐµÑ€Ð½Ð¸ÐºÐ° (Ð·Ð°Ð¼Ð¾Ñ€Ð¾Ð¶ÐµÐ½Ð½Ð°Ñ) â€” 420 â‚½/ÐºÐ³"
âœ… "ÐžÐ±Ð»ÐµÐ¿Ð¸Ñ…Ð° ÑÐ°Ð´Ð¾Ð²Ð°Ñ (Ð·Ð°Ð¼Ð¾Ñ€Ð¾Ð¶ÐµÐ½Ð½Ð°Ñ) â€” 210 â‚½/ÐºÐ³, ÐšÐ¸Ñ‚Ð°Ð¹"
âœ… "Ð‘ÐµÐ»Ñ‹Ð¹ Ð³Ñ€Ð¸Ð± (ÑÑƒÑˆÑ‘Ð½Ñ‹Ð¹) â€” Ð² Ð´Ð°Ð½Ð½Ñ‹Ð¹ Ð¼Ð¾Ð¼ÐµÐ½Ñ‚ Ð½ÐµÑ‚ Ð² Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ð¸"
âœ… "ÐšÐ°ÑˆÑ‚Ð°Ð½ Ñ†ÐµÐ»Ñ‹Ð¹ (Ð·Ð°Ð¼Ð¾Ñ€Ð¾Ð¶ÐµÐ½Ð½Ñ‹Ð¹) â€” 580 â‚½/ÐºÐ³, ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ: ÐžÑ€ÐµÑ…Ð¸"

### ÐšÐ¾Ð³Ð´Ð° Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð¾Ð² Ñ‚Ð¾Ð²Ð°Ñ€Ð°:
Ð•ÑÐ»Ð¸ ÐµÑÑ‚ÑŒ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð¾Ð² (Ñ€Ð°Ð·Ð½Ñ‹Ðµ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ¸/ÑÑ‚Ñ€Ð°Ð½Ñ‹), Ð¿ÐµÑ€ÐµÑ‡Ð¸ÑÐ»Ð¸ Ð²ÑÐµ:
"Ð£ Ð½Ð°Ñ ÐµÑÑ‚ÑŒ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð¾Ð²:
â€¢ Ð’Ð¸ÑˆÐ½Ñ Ð±ÐµÐ· ÐºÐ¾ÑÑ‚Ð¾Ñ‡ÐºÐ¸ (Ð·Ð°Ð¼Ð¾Ñ€Ð¾Ð¶ÐµÐ½Ð½Ð°Ñ) â€” 580 â‚½/ÐºÐ³, ÐšÐ¸Ñ€Ð³Ð¸Ð·Ð¸Ñ
â€¢ Ð’Ð¸ÑˆÐ½Ñ Ð±ÐµÐ· ÐºÐ¾ÑÑ‚Ð¾Ñ‡ÐºÐ¸ (Ð·Ð°Ð¼Ð¾Ñ€Ð¾Ð¶ÐµÐ½Ð½Ð°Ñ) â€” 590 â‚½/ÐºÐ³, ÐšÐ¸Ñ‚Ð°Ð¹"

### ÐšÐ¾Ð³Ð´Ð° Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð½ÐµÑ‚:
- Ð¡ÐºÐ°Ð¶Ð¸ Ñ‡Ñ‚Ð¾ Ñ‚Ð¾Ð²Ð°Ñ€Ð° Ð½ÐµÑ‚ Ð² Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ð¸
- ÐŸÑ€ÐµÐ´Ð»Ð¾Ð¶Ð¸ Ð¿Ð¾Ñ…Ð¾Ð¶Ð¸Ðµ Ð°Ð»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ñ‹ ÐµÑÐ»Ð¸ Ð¾Ð½Ð¸ ÐµÑÑ‚ÑŒ
- ÐÐ• Ð²Ñ‹Ð´ÑƒÐ¼Ñ‹Ð²Ð°Ð¹ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹ ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… Ð½ÐµÑ‚ Ð² Ð±Ð°Ð·Ðµ

### ÐšÐ¾Ð³Ð´Ð° ÐºÐ»Ð¸ÐµÐ½Ñ‚ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚ Ð¾ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸:
- ÐŸÐµÑ€ÐµÑ‡Ð¸ÑÐ»Ð¸ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹ Ð¸Ð· ÑÑ‚Ð¾Ð¹ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸
- Ð•ÑÐ»Ð¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ ÐµÑÑ‚ÑŒ Ð² Ð±Ð°Ð·Ðµ â€” Ð¾Ð½Ð° Ð¡Ð£Ð©Ð•Ð¡Ð¢Ð’Ð£Ð•Ð¢, Ð½Ðµ Ð¾Ñ‚Ñ€Ð¸Ñ†Ð°Ð¹ ÐµÑ‘ Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ðµ
- ÐŸÑ€ÐµÐ´Ð»Ð¾Ð¶Ð¸ ÑƒÑ‚Ð¾Ñ‡Ð½Ð¸Ñ‚ÑŒ ÐµÑÐ»Ð¸ ÑÐ¿Ð¸ÑÐ¾Ðº Ð±Ð¾Ð»ÑŒÑˆÐ¾Ð¹

## Ð’Ð°Ð¶Ð½Ñ‹Ðµ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ:
- ÐžÑ‚Ð²ÐµÑ‡Ð°Ð¹ Ð¢ÐžÐ›Ð¬ÐšÐž Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð½Ð¾Ð¹ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¾ Ñ‚Ð¾Ð²Ð°Ñ€Ð°Ñ…
- ÐÐµ Ð²Ñ‹Ð´ÑƒÐ¼Ñ‹Ð²Ð°Ð¹ Ñ†ÐµÐ½Ñ‹ Ð¸ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹
- Ð•ÑÐ»Ð¸ Ð½Ðµ ÑƒÐ²ÐµÑ€ÐµÐ½ â€” Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶Ð¸ ÑÐ²ÑÐ·Ð°Ñ‚ÑŒÑÑ Ñ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð¾Ð¼
- ÐÐµ Ð¾Ð±ÑÑƒÐ¶Ð´Ð°Ð¹ Ñ‚ÐµÐ¼Ñ‹ Ð½Ðµ ÑÐ²ÑÐ·Ð°Ð½Ð½Ñ‹Ðµ Ñ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ†Ð¸ÐµÐ¹ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸

## ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñ‹ Ð´Ð»Ñ ÑÐ²ÑÐ·Ð¸:
ðŸ“ž Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½: {phone}
ðŸ’¬ WhatsApp/Viber: {whatsapp}
ðŸ“§ Email: {email}
ðŸ“ ÐÐ´Ñ€ÐµÑ: Ð³. ÐšÐ¸Ñ€Ð¾Ð², Ð¿ÐµÑ€. Ð­Ð½Ð³ÐµÐ»ÑŒÑÐ°, 2

## Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑƒÑÐ»ÑƒÐ³Ð¸:
- Ð”Ð¾ÑÑ‚Ð°Ð²ÐºÐ° Ð¿Ð¾ Ð³Ð¾Ñ€Ð¾Ð´Ñƒ Ð¸ Ð¾Ð±Ð»Ð°ÑÑ‚Ð¸
- Ð Ð°Ð±Ð¾Ñ‚Ð°ÐµÐ¼ Ñ ÑŽÑ€Ð¸Ð´Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼Ð¸ Ð»Ð¸Ñ†Ð°Ð¼Ð¸
- Ð’Ð¾Ð·Ð¼Ð¾Ð¶ÐµÐ½ ÑÐ°Ð¼Ð¾Ð²Ñ‹Ð²Ð¾Ð· ÑÐ¾ ÑÐºÐ»Ð°Ð´Ð°
"""


# =============================================================================
# USER PROMPT TEMPLATE - Ð¨Ð°Ð±Ð»Ð¾Ð½ Ð´Ð»Ñ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
# =============================================================================

USER_PROMPT_TEMPLATE = """## Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð´Ð¸Ð°Ð»Ð¾Ð³Ð°:
{conversation_history}

## ÐÐ°Ð¹Ð´ÐµÐ½Ð½Ñ‹Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹ Ð¿Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑÑƒ:
{products_context}

## Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ Ð²Ð¾Ð¿Ñ€Ð¾Ñ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°:
{user_query}

---
ÐžÑ‚Ð²ÐµÑ‚ÑŒ Ð½Ð° Ð²Ð¾Ð¿Ñ€Ð¾Ñ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°. Ð£Ñ‡Ð¸Ñ‚Ñ‹Ð²Ð°Ð¹ Ð¸ÑÑ‚Ð¾Ñ€Ð¸ÑŽ Ð´Ð¸Ð°Ð»Ð¾Ð³Ð° Ð¸ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾ Ñ‚Ð¾Ð²Ð°Ñ€Ð°Ñ….
Ð•ÑÐ»Ð¸ Ð²Ð¾Ð¿Ñ€Ð¾Ñ ÑÐ²ÑÐ·Ð°Ð½ Ñ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ð¼Ð¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸ÑÐ¼Ð¸ â€” Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚, Ð½Ðµ Ð¿ÐµÑ€ÐµÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°Ð¹."""


# =============================================================================
# PRODUCT FORMATTING - Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¾ Ñ‚Ð¾Ð²Ð°Ñ€Ð°Ñ…
# =============================================================================

def format_product_for_prompt(product: dict) -> str:
    """Format a single product for the prompt context."""
    name = product.get("name", "ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ñ‹Ð¹ Ñ‚Ð¾Ð²Ð°Ñ€")
    category = product.get("category", "")
    form = product.get("product_form", "")
    price = product.get("price")
    is_available = product.get("is_available", False)
    origin = product.get("origin_country", "")
    
    # Build product line with explicit category
    parts = [f"â€¢ {name}"]
    
    if category:
        parts.append(f"[ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ: {category}]")
    
    if form:
        parts.append(f"({form.lower()})")
    
    if is_available and price:
        parts.append(f"â€” {price:.0f} â‚½/ÐºÐ³")
    else:
        parts.append("â€” Ð½ÐµÑ‚ Ð² Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ð¸")
    
    if origin:
        parts.append(f"Ð¡Ñ‚Ñ€Ð°Ð½Ð°: {origin}")
    
    return " ".join(parts)


def format_products_context(products: list[dict]) -> str:
    """Format list of products for the prompt context."""
    if not products:
        return "ÐŸÐ¾ Ð´Ð°Ð½Ð½Ð¾Ð¼Ñƒ Ð·Ð°Ð¿Ñ€Ð¾ÑÑƒ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹ Ð² Ð±Ð°Ð·Ðµ."
    
    lines = []
    for product in products:
        lines.append(format_product_for_prompt(product))
    
    return "\n".join(lines)


# =============================================================================
# CONVERSATION HISTORY FORMATTING
# =============================================================================

def format_conversation_history(messages: list, max_messages: int = 10) -> str:
    """Format conversation history for the prompt."""
    from langchain_core.messages import HumanMessage, AIMessage
    
    if not messages:
        return "Ð­Ñ‚Ð¾ Ð½Ð°Ñ‡Ð°Ð»Ð¾ Ð´Ð¸Ð°Ð»Ð¾Ð³Ð°."
    
    # Take last N messages
    recent_messages = messages[-max_messages:]
    
    lines = []
    for msg in recent_messages:
        if isinstance(msg, HumanMessage):
            lines.append(f"ÐšÐ»Ð¸ÐµÐ½Ñ‚: {msg.content}")
        elif isinstance(msg, AIMessage):
            lines.append(f"Ð¡ÐµÐ±Ð°ÑÑ‚ÑŒÑÐ½: {msg.content}")
    
    return "\n".join(lines) if lines else "Ð­Ñ‚Ð¾ Ð½Ð°Ñ‡Ð°Ð»Ð¾ Ð´Ð¸Ð°Ð»Ð¾Ð³Ð°."


# =============================================================================
# PROMPT BUILDERS
# =============================================================================

def build_system_prompt() -> str:
    """Build the system prompt with current settings."""
    return SYSTEM_PROMPT.format(
        phone=settings.escalation_phone,
        whatsapp=settings.escalation_whatsapp,
        email=settings.escalation_email,
    )


def build_user_prompt(
    conversation_history: str,
    products_context: str,
    user_query: str,
) -> str:
    """Build the user prompt with all context."""
    return USER_PROMPT_TEMPLATE.format(
        conversation_history=conversation_history,
        products_context=products_context,
        user_query=user_query,
    )


# =============================================================================
# SPECIAL RESPONSES
# =============================================================================

NO_PRODUCTS_RESPONSE = """Ðš ÑÐ¾Ð¶Ð°Ð»ÐµÐ½Ð¸ÑŽ, Ñ Ð½Ðµ Ð½Ð°ÑˆÑ‘Ð» "{query}" Ð² Ð½Ð°ÑˆÐµÐ¼ Ð°ÑÑÐ¾Ñ€Ñ‚Ð¸Ð¼ÐµÐ½Ñ‚Ðµ.

Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾, Ð²Ñ‹ Ð¸Ð¼ÐµÐ»Ð¸ Ð² Ð²Ð¸Ð´Ñƒ Ñ‡Ñ‚Ð¾-Ñ‚Ð¾ Ð´Ñ€ÑƒÐ³Ð¾Ðµ? Ð˜Ð»Ð¸ Ñ Ð¼Ð¾Ð³Ñƒ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶Ð¸Ñ‚ÑŒ Ð¿Ð¾Ñ…Ð¾Ð¶Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ñ‹.

Ð•ÑÐ»Ð¸ Ð½ÑƒÐ¶Ð½Ð° Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ â€” ÑÐ²ÑÐ¶Ð¸Ñ‚ÐµÑÑŒ Ñ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð¾Ð¼:
ðŸ“ž {phone}"""


def build_no_products_response(query: str) -> str:
    """Build response when no products found."""
    return NO_PRODUCTS_RESPONSE.format(
        query=query,
        phone=settings.escalation_phone,
    )